import re
import csv

# Example data in string format
data_string =  "'Invoice Number': 'INV0000000127','Issue Date': 'Sep 15, 2015','Total Amount': '480.00','Vendor': 'Sample Company Inc.','Invoice Number': '786594063079','Issue Date': '01 Apr, 2019','Total Amount': '81.76','Vendor': 'ShipWorks Webinar','Invoice Number': 'DEL5-2187145','Issue Date': '25.08.2019','Total Amount': '₹21,490.00','Vendor': 'Appario Retail Private Ltd','Invoice Number': 'HHGJGJJHG','Issue Date': '1-Apr-2008','Total Amount': '37,440.00','Vendor': 'SHRI KRISHNA MOTORS','Invoice Number': '14','Issue Date': '2018-09-25','Total Amount': '$2,608.20','Vendor': 'Turnpike Designs Co.','Invoice Number': 'RSN/18-19/14126','Issue Date': '9-Mar-2019','Total Amount': '76,900.00','Vendor': 'RECORD SHOPPEE','Invoice Number': '4444 AB123','Issue Date': '2010/09/15','Total Amount': '1,800.00','Vendor': 'company selling Goods to Canada, 125 Street, City, State, 12121, USA','Invoice Number': 'USMF-000003','Issue Date': '10-18-2022','Total Amount': '1,380.00','Vendor': 'Contoso Entertainment System USA','Invoice Number': '19-2038','Issue Date': '6/10/2019','Total Amount': '950.00','Vendor': 'SOLAR ELECTRIC VEHICLE SYSTEMS','Invoice Number': 'US-001','Issue Date': '11/02/2019','Total Amount': '154.06','Vendor': 'East Repair Inc.','Invoice Number': '1600390','Issue Date': '2016-08-27','Total Amount': '14.60 GBP','Vendor': 'Johny Seller','Invoice Number': '#982093','Issue Date': '20 AUGUST 2020','Total Amount': '$ 2112.25','Vendor': 'COMPANY DESIGNS','Invoice Number': 'INT-001','Issue Date': '11/02/2019','Total Amount': '$204.75','Vendor': 'John Smith','Invoice Number': '1009624','Issue Date': '04/01/2020','Total Amount': '$1,431.27','Vendor': 'TimelyBill','Invoice Number': 'B1674','Issue Date': '02.07.02','Total Amount': '125 EUR','Vendor': 'The Studio Graphics','Invoice Number': '14841','Issue Date': 'NULL','Total Amount': '4210.46','Vendor': 'VISION MOTORS PRIVATE LIMITED','Invoice Number': '1033810','Issue Date': '12/30/14','Total Amount': '46.86','Vendor': 'MADISON DISTRIBUTORS, INC.','Invoice Number': '76552','Issue Date': '12/11/2016','Total Amount': '53,000.00','Vendor': 'NULL','Invoice Number': '2491839','Issue Date': '24/06/2019','Total Amount': '$2,255.00','Vendor': 'AA Associates','Invoice Number': 'NULL','Issue Date': 'NULL','Total Amount': '$198.40','Vendor': 'Tesla Motors, Inc.','Invoice Number': '#INV2081','Issue Date': '11/11/18','Total Amount': '$2,844.80','Vendor': 'Stanford Plumbing & Heating','Invoice Number': '34567','Issue Date': '04 Jul 2022','Total Amount': '19860.00','Vendor': 'ABC Exports','Invoice Number': '0000002','Issue Date': '1/01/2008','Total Amount': '$278.30','Vendor': 'Accurate Expressions','Invoice Number': '51580','Issue Date': '06/20/2018','Total Amount': '1357.02','Vendor': 'LYLAC Inc.','Invoice Number': 'RathM-1617-00111','Issue Date': '14/07/2016','Total Amount': '708,994.00','Vendor': 'RATHOD MOTORS','Invoice Number': '1','Issue Date': '4-Apr-20','Total Amount': '52510.00','Vendor': 'Max Enterprises','Invoice Number': '1','Issue Date': '1-Apr-2008','Total Amount': '1,976.00','Vendor': 'SHRI KRISHNA MOTORS','Invoice Number': '42','Issue Date': '07-06-2021, 14:00','Total Amount': '$37.30','Vendor': 'My Cool Store','Invoice Number': '00020','Issue Date': '01-08-2017','Total Amount': '£3,696.00','Vendor': 'AXLSolutions Ltd','Invoice Number': '123456','Issue Date': '2015/05/07','Total Amount': '24.00','Vendor': 'MCA Est. Corp.','Invoice Number': 'NULL','Issue Date': '2018/08/21','Total Amount': '76.48','Vendor': 'Poon','Invoice Number': 'INV-17','Issue Date': '08/02/2020','Total Amount': '662.75','Vendor': 'Zylker','Invoice Number': 'US-001','Issue Date': '11/02/2019','Total Amount': '$154.06','Vendor': 'East Repair Inc.','Invoice Number': '0000376','Issue Date': '01-Apr-19','Total Amount': '465.67 GBP','Vendor': 'Findem Ltd','Invoice Number': 'INV-000099','Issue Date': '21/01/2021','Total Amount': '362.88','Vendor': 'Dangerous Toys R Us Ltd','Invoice Number': 'CT0001','Issue Date': '1-1-2021','Total Amount': '₹14,880.00','Vendor': 'Defmacro Software Pvt. Ltd','Invoice Number': 'NULL','Issue Date': '2017/09/13','Total Amount': '30.00','Vendor': 'Wayne Enterprises','Invoice Number': 'X4383 – 03','Issue Date': '14-Sep-21','Total Amount': '5,220.00','Vendor': 'Austen Tech Pty Ltd','Invoice Number': '336678888888','Issue Date': '8/07/202X','Total Amount': 'NULL','Vendor': 'ELECTRONICA CENTRE','Invoice Number': '0047','Issue Date': 'January 13, 2015','Total Amount': '$776.31','Vendor': 'Shopify Hardware Store','Invoice Number': '190','Issue Date': '1/28/2005','Total Amount': '$23,497.60','Vendor': 'AweFence, Inc.','Invoice Number': 'ATAJLP001','Issue Date': '22 JUNE 2022','Total Amount': '$4.00','Vendor': 'GANDULES','Invoice Number': '205','Issue Date': '11/03/93','Total Amount': '280832.00','Vendor': 'Segmented Marketing Services, Inc.','Invoice Number': 'INV/MNSG/17/110435','Issue Date': '20-Nov-2017','Total Amount': '44,780.00','Vendor': 'MICRODYN-NADIR SINGAPORE PTE LTD','Invoice Number': 'US-001','Issue Date': '11/02/2019','Total Amount': '$154.06','Vendor': 'East Repair Inc.','Invoice Number': '00000004','Issue Date': '1/01/2008','Total Amount': '$1,100.00','Vendor': 'Sample Company Pty Ltd','Invoice Number': '249','Issue Date': '24th June 2020','Total Amount': '$18.00','Vendor': 'EStore','Invoice Number': '090001','Issue Date': '9/24/2021','Total Amount': '$3,610.00','Vendor': 'Northern Star Design Studio','Invoice Number': '000562','Issue Date': '11/05/2020','Total Amount': '$12,512.00','Vendor': 'Globex Corporation','Invoice Number': 'A08029191212A017','Issue Date': 'Dec 12 2019','Total Amount': '530.10','Vendor': 'Balaji Infocom','Invoice Number': '1064','Issue Date': 'April 14, 2011','Total Amount': '125.09','Vendor': 'Valdosta Lowndes County Industrial Authority','Invoice Number': 'CLR 000009','Issue Date': '23/04/2017','Total Amount': 'Rs.12,334.89','Vendor': 'Vijaya Traders Private Limited','Invoice Number': 'US-001','Issue Date': '11/02/2019','Total Amount': '$154.06','Vendor': 'East Repair Inc.','Invoice Number': '2111111111','Issue Date': 'Nov 1 2021','Total Amount': '1,433.53','Vendor': 'LUMEN','Invoice Number': 'ABC-DEF-GB-2018-XXXXXXXX','Issue Date': '05.04.2018','Total Amount': '£564.00','Vendor': 'Amazon EU S.à.r.l., UK Branch','Invoice Number': '885','Issue Date': '19/02/2018','Total Amount': '96,415.00','Vendor': 'SAMARJEET AUTO','Invoice Number': 'BT-1638','Issue Date': '03JAN02','Total Amount': 'USD 309,400','Vendor': 'Baking Technologies, Inc.','Invoice Number': 'F7HMK20002','Issue Date': '25-09-2017','Total Amount': '5391','Vendor': 'Sane Retails Pvt Ltd','Invoice Number': '52148','Issue Date': '01/02/2020','Total Amount': '$220.00','Vendor': 'NULL','Invoice Number': '1129705','Issue Date': '18-Sep-2014','Total Amount': '136,320.00','Vendor': 'Varco B.J B.V.'"
# Specify the path for the CSV file


# Use regular expression to find key-value pairs
pattern = re.compile(r"'([^']+)'[^']*'([^']+)'")
matches = pattern.findall(data_string)

# Create a list of dictionaries from the matches
data_list = []
current_item = {}
for key, value in matches:
    current_item[key] = value
    if key == 'Vendor':
        data_list.append(current_item)
        current_item = {}

# Specify the path for the CSV file
csv_file_path = "C:\\Users\\bhand\\Desktop\\OpenCV\\dataverse\\4keys.csv"

# Write data to CSV file with UTF-8 encoding
with open(csv_file_path, 'w', newline='', encoding='utf-8') as csv_file:
    # Create a CSV writer object
    csv_writer = csv.writer(csv_file)

    # Write header
    csv_writer.writerow(['Invoice Number', 'Issue Date', 'Total Amount', 'Vendor'])

    # Write data rows
    for row in data_list:
        csv_writer.writerow([row.get('Invoice Number', ''), row.get('Issue Date', ''), row.get('Total Amount', ''), row.get('Vendor', '')])

print(f"Data has been written to: {csv_file_path}")

