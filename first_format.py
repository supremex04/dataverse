import re
import csv

data_string = "'Titles': 'ITEM NAME, UNITS, RATE, TOTAL','Product Details': 'Item name, Item name, Item name','Technical Details': 'Quantity: 2, 1, 3; Rate: $450.00, $300.00, $500.00; Subtotal: $2,700.00; Discount: -$100.00; Tax: 10.0%; Total Amount: $2,860.00 USD','Titles': 'Line No., Line No., Description, Quantity, Unit Price, Total Amount','Product Details': '2088 Pressure Transmitter, 1 EA, 1,435.20','Technical Details': 'Export HTS:9-9026.20400, ECCN:EAR99, License:NLR, Country of Origin:UNITED STATES, Serial Number:0521160','Titles': 'Description of Goods, Unit Quantity, Price, Amount','Product Details': 'Lightbulb 2 x 37 watt (Quantity: 1000, Price: 4.00), Elecwire 20m (Quantity: 450, Price: 28.00), Cable wire 40m (Quantity: 70, Price: 482.00)','Technical Details': 'N/A','Titles': 'No., Name, Qty, Rate, Disc., Taxable Amount, IGST %, IGST Amt, CGST %, CGST Amt, SGST %, SGST Amt, Cess','Product Details': 'GST Registration - Standard Package, Quantity: 1, Rate: 4152','Technical Details': 'Taxable Amount: 4152, IGST: 0%, IGST Amt: 0, CGST: 9%, CGST Amt: 373.68, SGST: 9%, SGST Amt: 373.68, Cess: 0','Titles': 'Date, Consultant, Service Provided, Time, Venue, Comments, Quantity, Item, Description, Vendor, Unit Price, Total','Product Details': '1 hr massage, Gift of massage therapy to recover from stress of conversation, MAA','Technical Details': '60 minutes, Teleconference, Tutorial on white privilege, 1, $70.00, $70.00','Titles': 'Description, Qty, Unit Price, Amount','Product Details': 'Brochure Design, Pamphlet Design, Web Banner Design','Technical Details': 'Quantity: 1 each, Unit Prices: 50.00, 100.00, 120.00 respectively','Titles': 'ITEM, DESCRIPTION, QUANTITY, SALES PRICE, DISCOUNT, AMOUNT','Product Details': 'D011: Lens, L0001: Mid-Range Speaker, P0001: Acoustic Foam Panel, D0003: Standard Speaker, T0001: Speaker cable 10, D0004: High End Speaker, T0004: Television M1270 37 Silver, T00002: Projector Television, T0005: Television HDTV X950 52 White, T0003: Surround Sound Receiver','Titles': 'Sl No','Product Details': 'Asus 16.6 inch Monitor','Technical Details': '10 Nos, 6,200.00 Nos','Titles': 'Product, Price, Quantity, Tax rate, VAT, Total','Product Details': 'Beanie with Logo, Belt, Cap','Technical Details': 'SKU: Woo-beanie-logo, SKU: woo-belt, SKU: woo-cap','Titles': 'Invoice Date, Order Date, SO Number, Ordered By, Customer PO Number, Payment Method, Warehouse, Ship Via, F.O.B., Salesperson, Resale Number, Order Quantity, Ship Quantity, Tax, Item Number / Description, U of M, Unit Price, Extended Price','Product Details': 'AEROCHAIR-E1 Aero E1 Executive Tile Chair, CHAIR-SW Office Chair - Swivel Grey','Technical Details': 'Order Quantity (10, 5), Ship Quantity (5, Y), Tax (Y), Unit Measure (Each, Set of 2, Set of 4), Unit Price ($500.00, $478.00, $699.00), Extended Price ($2,500.00, $2,390.00, $3,495.00)','Titles': 'Description, Quantity, Rate, Options, Total','Product Details': 'In-flight Pilot Training (Quantity: 05, Rate: $49.99), Preflight Briefing (Quantity: 05, Rate: $09.99), Post Flight Briefing and Evaluation (Quantity: 05, Rate: $09.99)','Technical Details': 'Invoice Date: 7/9/2015, Amount Due: $349.85, Sub Total: $349.85, Total: $349.85, Paid: $100.00, Owed: $249.85, Notes: Add 15% discount for group rate.','Titles': 'Quantity, Description, Unit Price, Ext Price','Product Details': '1 Certificate OWN C, 1 ASME Consultant(s) Expenses, 1 ASME Consultant(s) Services','Technical Details': 'Conducted July 25-26, 2012','Titles': 'PIECES, PACKAGE, DIMENSIONS, DESCRIPTION, WEIGHT, VOLUME','Product Details': '10 LD-11 PALLET (ATA TYPE 6), 50 BOX, 500 BOX, 50 PALLET - paper, Locomotive Parts, Iphone x, motor','Technical Details': '500.000 kg, 77.600 m3, 1020.000 kg, 4.100 ft3, 10206.000 kg, 41.100 ft3, 15000.000 kg, 53.100 ft3','Titles': '#, ITEM NAME, QTY, PRICE/UNIT, DISCOUNT/UNIT, GST, AMOUNT','Product Details': '1. Back-end services, 80 hrs, ₹72000.00, ₹0.00, ₹0.00, ₹80,000.00; 2. AWS Maintenance and set-up, 40 hrs, ₹20000.00, ₹0.00, ₹0.00, ₹40,000.00','Technical Details': 'SUBTOTAL ₹1,20,000.00, GST ₹0.00, TOTAL DUE ₹1,20,000.00','Titles': 'Product, Quantity, Unit price, Subtotal','Product Details': 'Apple®-iPad® with Retina® display Wi-Fi - 32GB - White, Recreational Flying Headset','Technical Details': 'CODE: I0241GCXF9, 3G Connectivity: No, Memory capacity: 16GB, CODE: rf250','Titles': 'Description, Quantity, Unit Price, Cost','Product Details': 'RXT-1 (1st installment, 10% of total purchase)','Technical Details': 'Quantity: 1, Unit Price: $5,475.00, Cost: $5,475.00','Titles': 'DESCRIPTION, HOURS, RATE, TOTAL','Product Details': 'WEDDING PHOTOSHOOT IN WACO, TEXAS AT THE WOOD HOMESTEAD BARNHOUSE, PHOTO EDITING FOR UP TO 30 IMAGES, DIGITAL IMAGES UPLOADED TO DROPBOX FOR CLIENT REVIEW, OTHER SERVICES','Technical Details': '8, 4, 1, 4; $150/HR, $150/HR, $150/HR, $150/HR; $1,200 USD, $600 USD, $150 USD, $600 USD','Titles': 'QUANTITY, DESCRIPTION, UNIT PRICE, AMOUNT','Product Details': '120 Widgets, 1000 Tin Badges','Technical Details': '6.00% Sales Tax Rate, $10.00 Unit Price for Widgets, $100 Unit Price for Tin Badges, $1,200.00 Amount for Widgets, $1,000.00 Amount for Tin Badges','Titles': 'DATE, EXPLANATION OF ACTIVITY, CHARGES, INSURANCE PAYMENT, INSURANCE PENDING, PATIENT PAYMENTS','Product Details': 'Balance Forward, Payment Check','Technical Details': '05/18/12, 07/08/12, 07/19/12, 7149.85, 2112.06, 0.00, 4998.14','Titles': 'Product, Price, Quantity, Line Total','Product Details': 'Flying Ninja, Happy Ninja, Woo Ninja','Technical Details': '£12.00, 6, £72.00; £18.00, 1, £18.00; £15.00, 2, £30.00','Titles': 'S.No., Parts/OP code, Part Labor Description, HSN/SAC, Tax%, Qty, Rate/Unit, Disc Amt, Amount','Product Details': 'PAD KIT-FRONT DISC BRAKE, FILTER CARTRIDGE, SERVICE KIT-OIL FILTER, FILTER-AIR CLEANER, SYNTHETIC ENGINE OIL IOCL','Technical Details': 'Labour and Services, Engine Cleaning/Dressing Large, EGR cleaner, Periodic Maintenance Service (PMS), Dry wash (FOC), Service Pro Large, Pick & Drop on FOC','Titles': 'Qty','Titles': 'Full Description of Goods 8, Customs Commodity Code 9, Country of Manufacture 10, Qty. 11, Unit Value 12, Subtotal Value and Currency 13','Product Details': 'Populated Printed Circuit Board, 10 Pcs, Laser Imaging Assembly, 2 Pcs','Technical Details': 'HTS #8473.30, Manufactured in South Korea, HTS #8473.30, Manufactured in Mexico','Titles': 'ITEM NAME, HSN/SAC, QTY, PRICE/ UNIT, DISCOUNT/ UNIT, GST, AMOUNT','Product Details': 'Herman Miller Executive Chair, VG248 QE 24 Monitor','Technical Details': 'HSN 34929, QTY 12 Pcs, PRICE ₹100.00, GST 12%, HSN 34174, QTY 12 Pcs, PRICE ₹100.00, GST 12%','Titles': 'Product, Cost, Qty, Disc, Total','Product Details': 'Item description','Technical Details': 'Cost: $500.00, Qty: 1, Disc: 15%, Total: $425.00','Titles': 'Sl No, Description of Goods, Quantity, Rate, per, Amount','Product Details': 'Asus 16.6 inch Monitor','Technical Details': '15 Nos, 6200.00, 93,000.00','Titles': 'Product, Quantity, Price','Product Details': 'Simple product, SKU: Simple01','Technical Details': 'Quantity: 1, Price: €100.00, Shipping: €10.00 via Flat Rate, Low 10% VAT: €11.00, Payment Method: Cash on Delivery, Order Total: €121.00','Titles': 'S.no, Item, Checked parameters, Remarks','Product Details': 'Wall Mounting, Connection tightness, Feeder MCB make & rating, Feeder input cable rating, Power cable rating, Power cable actual length, Earthing Available, Earthing wire type, Earthing wire actual Length, Any loose connections, Mains Input I-L-N, Mains Input PE-N','Technical Details': '3.5Sqmm RECCA, 32Amps, 23mtrs, 9.55qmm BLACK, 20.6mtrs, R-Y-B, O-Y-B, Earth-pit, Energy Meter, RCCB, etc.','Titles': 'DATE, EMPLOYEE, DESCRIPTION, HOURS, RATE, AMOUNT','Product Details': 'Professional Services: Pickup Redline Corrections, Client Meeting, Elevations; Expenses: Copies','Technical Details': 'Total Services: 12.50 Hours, Total Expenses: $6.50, Total Amount Due Including This Invoice: $6,999.24','Titles': 'Sr. No, Part No/Job Code, Particulars, Type, UoM, Qty, Rate(Rs), Disc. (%), VAT %, VAT (Rs), Amount(Rs)','Product Details': '72103J, AJUST DOOR LINKS FOE R ACK DOOR CHECK DOLOR L UCK & SETTING DUNE, FREESERVI, EACH, 1, PAID','Technical Details': 'STANDARD CHECKS (TEFLO N COATING DONE ), STANDARD CHECKS( GENERAL FAST FREE UP DONE), STANDARD CHECKS(SERVICE PLUS)','Titles': 'Sl No, Particulars, Quantity, Rate, per, Amount','Product Details': 'Repairs and Maintenance Charges','Technical Details': 'Quantity Not Specified, Rate 7,000.00','Titles': 'Description, HTS Code, Country of Origin, Units, Unit Price, Total Value','Product Details': 'WOVEN BACKPACK 100% NYLON, WOVEN TRAVEL LUGGAGE 100% NYLON, WOVEN SHOULDER BAG 100% NYLON, WOVEN SACK BAG 100% NYLON, WOVEN PUNCH BAG 100% NYLON, WOVEN BACKPACK 100% NYLON, WOVEN LARGE POUCH 100% NYLON, WOVEN OUT GEAR PACK 100% NYLON, WOVEN BOTTLE CARRIER 100% NYLON, WOVEN SINGLE GUN CASE 100% NYLON, WOVEN KNEE PADS 100% NYLON, TAC-AX TAC LEATHER GLOVES 100% NYLON, MANCOK GLOVES 100% NYLON, TDU BELT SUPPORT PLATE WOVEN CARBON FIBER, TDU BELT 1.75 100% NYLON/PLASTIC BUCKLE','Titles': 'Description of Goods, Tariff Code, Country of Origin, Quantity, Unit £, Total £','Product Details': 'AL-D-6 Alison Tunic - Size: 6, AL-D-8 Alison Tunic - Size: 8, AL-D-10 Alison Tunic - Size: 10, AL-D-12 Alison Tunic - Size: 12, AL-D-14 Alison Tunic - Size: 14, AN-D-6 Angie Dress - Size: 6, AN-D-8 Angie Dress - Size: 8, AN-D-10 Angie Dress - Size: 10, AN-D-12 Angie Dress - Size: 12, AN-D-14 Angie Dress - Size: 14, 100% Cotton','Technical Details': '62044220, United Kingdom, Quantity varies per item (1-6), Unit £25.00, Total £ varies per item (£25.00-£150.00)','Titles': 'Description, Amount','Product Details': 'DJ & MC Performance, Equipment & Lightning, Videography, Photo Booth','Technical Details': 'Duration: 5 Hour, Number of Participants: 51-80, Duration: 5 Hour, Duration: 5 Hour','Titles': 'DESCRIPTION, QUANTITY, PRICE, SALES TAX, AMOUNT','Product Details': 'Black Tea','Technical Details': 'QUANTITY: 2.00, PRICE: $5.00, SALES TAX: Yes, AMOUNT: $10.00','Titles': 'DESCRIPTION, QUANTITY, TOTAL PRICE','Product Details': 'DOORES AND WINDOWS ACCESORY, 2,000.00 Pcs, 100,000.00 USD','Technical Details': 'Delivery Terms: CIF TRIPOLI PORT LIBYA, Shipment: 2x40ft Dry Containers, Port of Shipment: Port of Felixstowe, Payment: IRREVOCABLE CONFIRMED LETTER OF CREDIT, L/C Number: 53221Z2004, Account Holder: FLUID LIMITED Fluid Centre, 120 Pinehurst Road, Farnborough, KU12 7VG, UK, Bank: HSBC, IBAN EURO: GB15MLD40051512345678, Swift: MLDGB22I23','Titles': 'Ordered, This Shipment, To Follow, Unit Price, VAT, Item Total','Product Details': 'Samsung Galaxy Note 8 (SM-N950FZKABTU, 64GB, Black), Samsung Galaxy Note 8 Clear View Standing Cover (EF-ZN950CNEGWW Deep Blue)','Technical Details': 'Quantity: 1, 1; Unit Price: 724.17 S, 40.83 S','Titles': 'DESCRIPTION, QTY, PRICE, TOTAL','Product Details': 'Web Design, Branding, Graphic Design, Web Development','Technical Details': 'Quantity: 1, 1, 27, 1; Price Each: $200.00, $350.00, $55.00, $450.00','Titles': 'ITEM NAME, HSN/SAC, QTY, PRICE/UNIT, DISCOUNT/UNIT, GST, AMOUNT','Product Details': '1 - Wireless Mouse Robots, 8 Pcs at ₹1000.00 each, 12% GST, ₹8,960.00 Total; 2 - Herman Miller Executive Chair, 4 Pcs at ₹1000.00 each, 12% GST, ₹1,480.00 Total','Technical Details': 'HSN/SAC Codes: 34895, Quantities: 8 Pcs, 4 Pcs','Titles': 'Date, By, Services, Hours, Rates, Amount, Expenses','Product Details': 'A104 - Review/analyze, A105 - Communicate (in firm), E101 - Copying','Technical Details': 'Hours: 2.30, 0.84, Total Hours: 3.14 hrs, Rates: $125.00/hr, Amount: $287.50, $105.00, Total Labor: $392.50, Amount: $43.95, Total Expenses: $43.95','Titles': 'Product Description, Amount','Product Details': 'NANO TWIST XTA, TATA NANO TWIST XTA, 273SI MPFI BS-IV PETROL ENGINE BS IV (EPAS), 5 SPEED TRANSAXLE, 5 NO WHEEL RDMS, 3 NOS 135/70R12 & 2 NOS 155/65/R12TYRES, 22230MM W.B. SEATING CAPACITY 3+ DRIVER, HVAC, COLOUR BANGRIA RED','Technical Details': 'CHASSIS NO. MAT612263FKG12484, ENGINE NO. 273MPF11GUYK11531'"

pattern = re.compile(r"'([^']+)'[^']*'([^']+)'")
matches = pattern.findall(data_string)

data_list = []
current_item = {}
for key, value in matches:
    current_item[key] = value
    if key == 'Technical Details':
        data_list.append(current_item)
        current_item = {}

csv_file_path = "C:\\Users\\bhand\\Desktop\\OpenCV\\dataverse\\testtablekeys.csv"

with open(csv_file_path, 'w', newline='', encoding='utf-8') as csv_file:
    csv_writer = csv.writer(csv_file)

    csv_writer.writerow(['Titles', 'Product Details', 'Technical Details'])

    for row in data_list:
        csv_writer.writerow([row.get('Titles', ''), row.get('Product Details', ''), row.get('Technical Details', '')])

print(f"Data has been written to: {csv_file_path}")
